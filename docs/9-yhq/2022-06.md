[toc]

## Todo

- [x] echarts图表

- [x] vue中导出pdf 

- [x] 设置水印

- [x] uni-app分包

- [x] vue设置页签

- [x] 获取元素宽高的其他方式

- [x] vue全局注册组件

  
  
  

## echarts图表

### vue中安装下载

```javascript
npm install echarts
```

### main.js中注册

```
import echarts from "echarts"
//vue2
Vue.prototype.$echarts = echarts;
//vue3
app.config.globalProperties.$echarts = echarts;
```

### 页面上使用

```
<!-- 为 ECharts 准备一个定义了宽高的 DOM -->
<div id="main" style="width: 600px;height:400px;"></div>
```

```
initChart() {
	// 基于准备好的dom，初始化echarts实例
	//westerosa 为外部设置的公共样式（可不写）
    let myChart = this.$echarts.init(document.getElementById('main'),'westerosa')
    // 绘制图表
    //option 配置项
    //notMerge  可选，是否不跟之前设置的 option 进行合并，默认为 false，即合并
    //lazyUpdate 可选，没用过
    myChart.setOption(option,notMerge,lazyUpdate）
}
```

配置项 参考 https://echarts.apache.org/zh/option.html

我目前用到的配置项（仅供参考）

```
//提示框组件。
tooltip: {
	show: true,//是否显示
	
	//触发类型
	// item 数据项图形触发，主要在散点图，饼图等无类目轴的图表中使用
	// axis 坐标轴触发，主要在柱状图，折线图等会使用类目轴的图表中使用。
	// none 什么都不触发。
	trigger: '',  
	
	//提示框浮层内容格式器，支持字符串模板和回调函数两种形式。
	//折线（区域）图、柱状（条形）图、K线图 : {a}（系列名称），{b}（类目值），{c}（数值）, {d}（无）
    //散点图（气泡）图 : {a}（系列名称），{b}（数据名称），{c}（数值数组）, {d}（无）
    //地图 : {a}（系列名称），{b}（区域名称），{c}（合并数值）, {d}（无）
    //饼图、仪表盘、漏斗图: {a}（系列名称），{b}（数据项名称），{c}（数值）, {d}（百分比）
	formatter: "性别: {b}<br/>员工人数: {c}({d}%)"
	formatter: ["{b}:", "{d}%"].join("\n")
	
	//具体图形配置
	series: [
		{
			type: ''， //类型 
			data：[],//数据
		}
	]
	
},
//图形绘制
grid: {
    top： 0，//grid 组件离容器上侧的距离。 值可选 像素值、百分比、'top', 'middle', 'bottom'组件会根据相应的位置自动对齐。
    left： 0，//左 ，同上
    right： 0，//右 ，同上
    bootom： 0，//下 ，同上
    containLabel： true //grid 区域是否包含坐标轴的刻度标签。这常用于『防止标签溢出』的场景
},
//主题颜色
color: [],


（不想写了，具体的看链接-_-）
```

### 事件

```
myChart.on('click', function (params) {
    console.log(params);
});

myChart.on('legendselectchanged', function (params) {
    console.log(params);
});

chart.on('click', 'series.line', function (params) {
    console.log(params);
});

chart.on('mouseover', {seriesIndex: 1, name: 'xx'}, function (params) {
    console.log(params);
});
```

  https://echarts.apache.org/zh/api.html#events

## vue中导出pdf 

### js部分

```
import html2Canvas from "html2canvas";
import JsPDF from "jspdf";
export default {
  install(Vue, options) {
     //title 文件名
    Vue.prototype.getPdf = function(title) {
      //dom
      let pdfDom = document.querySelector("#pdfDom");
      html2Canvas(pdfDom, {
        allowTaint: true
      }).then(function(canvas) {
        let pageData = canvas.toDataURL("image/jpeg", 1);
        //l 横向 '' 纵向
        let PDF = new JsPDF("l", "pt", "a4");
        PDF.addImage(pageData, "JPEG", 0, 0);
        PDF.save(title + ".pdf");
      });
    };
  }
};
```

### html部分

```
<div @click="getPdf('文件名')">
	//要导出的内容
    <div id="pdfDom">
    	
    </div>
</div>
```

## 设置水印

### js部分

```
addWaterMark() {
	//要显示的内容
    const userInfo = JSON.parse(sessionStorage.getItem("userInfo")); 
    const strArr1 = `${userInfo.userName}`;
    const strArr2 = `${new Date()}`;
    
    let ctx = document.createElement("canvas");
    //水印大小
    ctx.width = 450;
    ctx.height = 170;
    ctx.style.display = "none";
    let cans = ctx.getContext("2d");
    //旋转度
    cans.rotate(-0.2);
    cans.font = "12px Mincrosoft YaHei";
    cans.fillStyle = "rgba(17,17,17,0.2)";
    cans.textAlign = "left";
    cans.textBaseline = "middle";
    //添加文字
    cans.fillText(strArr1, 0, 50);
    cans.fillText(strArr2, 0, 70);
    cans.save();
    return ctx.toDataURL();
  }
```

### html

```
<div :style="{backgroundImage: `url(${getWaterMarkStatus})`></div>
//用的是iview 请忽略
<Form label-position="left">
    <FormItem label="是否开启水印">
      <i-switch
        v-model="flag"
        :true-value="1"
        :false-value="0"
        size="large"
        @on-change="upDateWaterMarkStatus"
      >
        <template #open>
          <span>开启</span>
        </template>
        <template #close>
          <span>关闭</span>
        </template>
      </i-switch>
    </FormItem>
</Form>

computed: {
	//结合store 通过按钮动态改变
    getWaterMarkStatus() {
        return this.$store.getters.getWaterMarkStatus == 1
        ? watermark.addWaterMark()
        : "";
    }，
  
},

methods: {
    upDateWaterMarkStatus(val) {
        this.$store.commit("setWaterMarkStatus", val);
    }
  }
```

### store

getters

```
getWaterMarkStatus: state => {
      return state.isShowWaterMark;
    }
```

mutations

```
setWaterMarkStatus(state, flag) {
      state.isShowWaterMark = flag;
    },
```

## uni-app分包

pages.json中

```
"pages": [...],
//项目过大可采用分包
"subPackages":[{
		"root":"packageA",  //根目录下的分包文件路径
		"name":"packageA",  //分包文件名字
		//pages里面一样写法
		"pages":[...]
	}],
```

## vue设置页签

document.title = ''

## 获取元素宽高的其他方式



```
var oDiv = document.getElementById("box");
```



### 通过 getComputedStyle获取元素宽高

```
//只支持获取, 不支持设置
 var style = getComputedStyle(oDiv);
```

### 通过 currentStyle属性获取宽高

```css
   获取的宽高不包括 边框和内边距
   既可以获取行内设置的宽高也可以获取CSS设置的宽高
   只支持获取, 不支持设置
   只支持IE9以下的浏览器
```

```
//只支持获取, 不支持设置
var style = oDiv.currentStyle;
```

## vue全局注册组件

vue提供install可供我们开发新的插件及全局注册组件等
install方法第一个参数是vue的构造器，第二个参数是可选的选项对象

```
export default {
	install(Vue,option) {
		组件
		指令
		混入
		挂载vue原型
	}
}
```

### **全局注册组件**

注册后可直接在页面上使用 



```
import MenuComponent from "./core/MenuComponent";
/**
 * 组件注册
 */
const Component = {
	install(Vue) {
		//组件
		Vue.component("menu", MenuComponent);
	}
}
export default Component;



```

```
main.js
import Component from ''
Vue.use(Component)
```

```
<menu />
```

### 
